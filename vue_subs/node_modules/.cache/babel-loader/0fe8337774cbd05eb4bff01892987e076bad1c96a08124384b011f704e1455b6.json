{"ast":null,"code":"import \"core-js/modules/esnext.iterator.constructor.js\";\nimport \"core-js/modules/esnext.iterator.filter.js\";\n/**\r\n * A collection of DOM-related functions.\r\n */\nimport { __extends } from \"tslib\";\n/**\r\n * ============================================================================\r\n * IMPORTS\r\n * ============================================================================\r\n * @hidden\r\n */\nimport { Disposer } from \"./Disposer\";\nimport { readFrame, writeFrame } from \"./AsyncPending\";\nimport { options } from \"../Options\";\nimport * as $object from \"./Object\";\nimport * as $array from \"./Array\";\nimport * as $type from \"./Type\";\n/**\r\n * SVG namespace.\r\n *\r\n * @ignore Exclude from docs\r\n */\nexport var SVGNS = \"http://www.w3.org/2000/svg\";\n/**\r\n * XML namespace.\r\n *\r\n * @ignore Exclude from docs\r\n */\nexport var XMLNS = \"http://www.w3.org/2000/xmlns/\";\n/**\r\n * XLINK namespace.\r\n *\r\n * @ignore Exclude from docs\r\n */\nexport var XLINK = \"http://www.w3.org/1999/xlink\";\n/**\r\n * Function that adds a disposable event listener directly to a DOM element.\r\n *\r\n * @ignore Exclude from docs\r\n * @param dom       A DOM element to add event to\r\n * @param type      Event type\r\n * @param listener  Event listener\r\n * @returns Disposable event\r\n */\nexport function addEventListener(dom, type, listener, options) {\n  //@todo proper type check for options: EventListenerOptions | boolean (TS for some reason gives error on passive parameter)\n  //console.log(type, dom);\n  dom.addEventListener(type, listener, options || false);\n  return new Disposer(function () {\n    dom.removeEventListener(type, listener, options || false);\n  });\n}\n/**\r\n * Finds and returns an element reference using following logic:\r\n * * If we pass in an element instance, we just return it back.\r\n * * If we pass in a string, the function looks for an element with such id.\r\n * * If no element with such id is found, we grab the first element with a tag name like this.\r\n *\r\n * @ignore Exclude from docs\r\n * @param el  Element definition (reference, or id, or tag name)\r\n * @return Element reference\r\n * @todo Review this function as it seems pretty fuzzy and hacky\r\n */\nexport function getElement(el) {\n  if ($type.isString(el)) {\n    var e = document.getElementById(el);\n    if (e == null) {\n      e = document.getElementsByClassName(el)[0];\n    }\n    if (e instanceof HTMLElement) {\n      return e;\n    }\n  } else if (el instanceof HTMLElement) {\n    return el;\n  }\n}\n/**\r\n * Adds a class name to an HTML or SVG element.\r\n *\r\n * @ignore Exclude from docs\r\n * @param element    Element\r\n * @param className  Class name to add\r\n */\nexport function addClass(element, className) {\n  if (!element) {\n    return;\n  }\n  if (element.classList) {\n    var classes = className.split(\" \");\n    $array.each(classes, function (name) {\n      element.classList.add(name);\n    });\n  } else {\n    var currentClassName = element.getAttribute(\"class\");\n    if (currentClassName) {\n      element.setAttribute(\"class\", currentClassName.split(\" \").filter(function (item) {\n        return item !== className;\n      }).join(\" \") + \" \" + className);\n    } else {\n      element.setAttribute(\"class\", className);\n    }\n    //element.className = element.className.replace(new RegExp(\"^\" + className + \"| \" + className), \"\") + \" \" + className;\n  }\n}\n/**\r\n * Removes a class name from an HTML or SVG element.\r\n *\r\n * @ignore Exclude from docs\r\n * @param element    Element\r\n * @param className  Class name to add\r\n */\nexport function removeClass(element, className) {\n  if (!element) {\n    return;\n  }\n  if (element.classList) {\n    element.classList.remove(className);\n  } else {\n    var currentClassName = element.getAttribute(\"class\");\n    if (currentClassName) {\n      element.setAttribute(\"class\", currentClassName.split(\" \").filter(function (item) {\n        return item !== className;\n      }).join(\" \"));\n    }\n    //element.className = element.className.replace(new RegExp(\"^\" + className + \"| \" + className), \"\");\n  }\n}\n/**\r\n * Sets style property on DOM element.\r\n *\r\n * @ignore Exclude from docs\r\n * @todo Still needed?\r\n */\nexport function setStyle(element, property, value) {\n  element.style[property] = value;\n}\n/**\r\n * Gets the computed style value for an element.\r\n *\r\n * @ignore Exclude from docs\r\n */\nexport function getComputedStyle(element, property) {\n  if (element.currentStyle) {\n    return element.currentStyle[property];\n  }\n  return document.defaultView.getComputedStyle(element, null).getPropertyValue(property);\n}\n/**\r\n * Removes focus from any element by shifting focus to body.\r\n *\r\n * @ignore Exclude from docs\r\n */\nexport function blur() {\n  if (document.activeElement && document.activeElement != document.body) {\n    if (document.activeElement.blur) {\n      document.activeElement.blur();\n    } else {\n      var input = document.createElement(\"button\");\n      input.style.position = \"fixed\";\n      input.style.top = \"0px\";\n      input.style.left = \"-10000px\";\n      document.body.appendChild(input);\n      input.focus();\n      input.blur();\n      document.body.removeChild(input);\n    }\n  }\n}\n/**\r\n * Tries to focus the element.\r\n *\r\n * @ignore Exlude from docs\r\n * @param element  Element to focus\r\n */\nexport function focus(element) {\n  if (element instanceof HTMLElement) {\n    element.focus();\n  } else {\n    var input = document.createElement(\"input\");\n    var fo = document.createElementNS(SVGNS, \"foreignObject\");\n    fo.appendChild(input);\n    element.appendChild(fo);\n    input.focus();\n    input.disabled = true;\n    fo.remove();\n  }\n  /*if ((<any>element).focus != undefined) {\r\n      (<any>element).focus();\r\n  }\r\n  else if (element instanceof SVGSVGElement) {\r\n      // Not implemented\r\n      // @todo implement focus fallback\r\n  }*/\n}\n/**\r\n * Returns markup for the element including the element tag itself.\r\n * SVG elements do not support `outerHTML` so this functions applies of\r\n * a workaround which creates a new temporary wrapper, clones element and uses\r\n * wrapper's `innerHTML`.\r\n *\r\n * @ignore Exclude from docs\r\n * @param element  Element to get full markup for\r\n * @return Markup\r\n * @deprecated Not in use anywhere\r\n */\nexport function outerHTML(element) {\n  if (element.outerHTML) {\n    return element.outerHTML;\n  } else {\n    var twrap = document.createElement(\"div\");\n    var tnode = element.cloneNode(true);\n    twrap.appendChild(tnode);\n    var content = twrap.innerHTML;\n    return content;\n  }\n}\n/**\r\n * Checks if element is a valid DOM node.\r\n *\r\n * @ignore Exclude from docs\r\n * @param el  Element\r\n * @return `true` if element is a valid DOM node\r\n */\nexport function isElement(el) {\n  return el instanceof Object && el && el.nodeType === 1;\n}\n/**\r\n * Checks of element `a` contains element `b`.\r\n *\r\n * @param a  Aleged ascendant\r\n * @param b  Aleged descendant\r\n * @return Contains?\r\n */\nexport function contains(a, b) {\n  var cursor = b;\n  while (true) {\n    if (a === cursor) {\n      return true;\n    } else if (cursor.parentNode == null) {\n      // TODO better ShadowRoot detection\n      if (cursor.host == null) {\n        return false;\n      } else {\n        cursor = cursor.host;\n      }\n    } else {\n      cursor = cursor.parentNode;\n    }\n  }\n}\n/**\r\n * Returns the shadow root of the element or null\r\n *\r\n * @param a  Node\r\n * @return Root\r\n */\nexport function getShadowRoot(a) {\n  var cursor = a;\n  while (true) {\n    if (cursor.parentNode == null) {\n      // TODO better ShadowRoot detection\n      if (cursor.host != null) {\n        return cursor;\n      } else {\n        return null;\n      }\n    } else {\n      cursor = cursor.parentNode;\n    }\n  }\n}\n/**\r\n * Returns the root of the element (either the Document or the ShadowRoot)\r\n *\r\n * @param a  Node\r\n * @return Root\r\n */\nexport function getRoot(a) {\n  // TODO replace with Node.prototype.getRootNode\n  var owner = a.ownerDocument;\n  var cursor = a;\n  while (true) {\n    if (cursor.parentNode == null) {\n      // If the cursor is the document, or it is a ShadowRoot\n      // TODO better ShadowRoot detection\n      if (cursor === owner || cursor.host != null) {\n        return cursor;\n      } else {\n        return null;\n      }\n    } else {\n      cursor = cursor.parentNode;\n    }\n  }\n}\n/**\r\n * Gets the true target of the Event.\r\n *\r\n * This is needed to make events work with the shadow DOM.\r\n *\r\n * @param event  Event\r\n * @return EventTarget\r\n */\nexport function eventTarget(event) {\n  if (typeof event.composedPath === \"function\") {\n    return event.composedPath()[0];\n  } else {\n    return event.target;\n  }\n}\n/**\r\n * Copies attributes from one element to another.\r\n *\r\n * @ignore Exclude from docs\r\n * @param source  Element to copy attributes from\r\n * @param target  Element to copy attributes to\r\n */\nexport function copyAttributes(source, target) {\n  $array.each(source.attributes, function (attr) {\n    // TODO what if it's null ?\n    if (attr.value != null) {\n      target.setAttribute(attr.name, attr.value);\n    }\n  });\n}\n/**\r\n * [fixPixelPerfect description]\r\n *\r\n * @ignore Exclude from docs\r\n * @todo Description\r\n * @param el  Element\r\n */\nexport function fixPixelPerfect(el) {\n  readFrame(function () {\n    // sometimes IE doesn't like this\n    // TODO figure out a way to remove this\n    try {\n      var rect = el.getBoundingClientRect();\n      var left_1 = rect.left - Math.round(rect.left);\n      var top_1 = rect.top - Math.round(rect.top);\n      if (left_1 !== 0) {\n        writeFrame(function () {\n          el.style.left = left_1 + \"px\";\n        });\n      }\n      if (top_1 !== 0) {\n        writeFrame(function () {\n          el.style.top = top_1 + \"px\";\n        });\n      }\n    } catch (e) {}\n  });\n}\n/**\r\n * [rootStylesheet description]\r\n *\r\n * @ignore Exclude from docs\r\n * @todo Description\r\n */\nvar rootStylesheet;\n/**\r\n * [getStylesheet description]\r\n *\r\n * @ignore Exclude from docs\r\n * @todo Description\r\n * @return [description]\r\n */\nfunction getStylesheet(element) {\n  if (element == null) {\n    if (!$type.hasValue(rootStylesheet)) {\n      // TODO use createElementNS ?\n      var e = document.createElement(\"style\");\n      e.type = \"text/css\";\n      if (options.nonce != \"\") {\n        e.setAttribute(\"nonce\", options.nonce);\n      }\n      document.head.appendChild(e);\n      rootStylesheet = e.sheet;\n    }\n    return rootStylesheet;\n  } else {\n    // TODO use createElementNS ?\n    var e = document.createElement(\"style\");\n    e.type = \"text/css\";\n    if (options.nonce != \"\") {\n      e.setAttribute(\"nonce\", options.nonce);\n    }\n    element.appendChild(e);\n    return e.sheet;\n  }\n}\n/**\r\n * [makeStylesheet description]\r\n *\r\n * @ignore Exclude from docs\r\n * @todo Description\r\n * @param selector  [description]\r\n * @return [description]\r\n */\nfunction appendStylesheet(root, selector) {\n  var index = root.cssRules.length;\n  root.insertRule(selector + \"{}\", index);\n  return root.cssRules[index];\n}\n/**\r\n * Defines a class for a CSS rule.\r\n *\r\n * Can be used to dynamically add CSS to the document.\r\n */\nvar StyleRule = /** @class */function (_super) {\n  __extends(StyleRule, _super);\n  /**\r\n   * Constructor.\r\n   *\r\n   * @param selector  CSS selector\r\n   * @param styles    An object of style attribute - value pairs\r\n   */\n  function StyleRule(element, selector, styles) {\n    var _this = this;\n    var root = getStylesheet(element);\n    // TODO test this\n    _this = _super.call(this, function () {\n      // TODO a bit hacky\n      var index = $array.indexOf(root.cssRules, _this._rule);\n      if (index === -1) {\n        throw new Error(\"Could not dispose StyleRule\");\n      } else {\n        // TODO if it's empty remove it from the DOM ?\n        root.deleteRule(index);\n      }\n    }) || this;\n    _this._rule = appendStylesheet(root, selector);\n    $object.each(styles, function (key, value) {\n      _this.setStyle(key, value);\n    });\n    return _this;\n  }\n  Object.defineProperty(StyleRule.prototype, \"selector\", {\n    /**\r\n     * @return CSS selector\r\n     */\n    get: function () {\n      return this._rule.selectorText;\n    },\n    /**\r\n     * A CSS selector text.\r\n     *\r\n     * E.g.: `.myClass p`\r\n     *\r\n     * @param selector  CSS selector\r\n     */\n    set: function (selector) {\n      this._rule.selectorText = selector;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  /**\r\n   * Sets the same style properties with browser-specific prefixes.\r\n   *\r\n   * @param name   Attribute name\r\n   * @param value  Attribute value\r\n   */\n  StyleRule.prototype._setVendorPrefixName = function (name, value) {\n    var style = this._rule.style;\n    style.setProperty(\"-webkit-\" + name, value, \"\");\n    style.setProperty(\"-moz-\" + name, value, \"\");\n    style.setProperty(\"-ms-\" + name, value, \"\");\n    style.setProperty(\"-o-\" + name, value, \"\");\n    style.setProperty(name, value, \"\");\n  };\n  /**\r\n   * Sets a value for specific style attribute.\r\n   *\r\n   * @param name   Attribute\r\n   * @param value  Value\r\n   */\n  StyleRule.prototype.setStyle = function (name, value) {\n    if (name === \"transition\") {\n      this._setVendorPrefixName(name, value);\n    } else {\n      this._rule.style.setProperty(name, value, \"\");\n    }\n  };\n  return StyleRule;\n}(Disposer);\nexport { StyleRule };\n/**\r\n * An internal counter for unique style ids.\r\n *\r\n * @ignore Exclude from docs\r\n */\nvar styleId = 0;\n/**\r\n * @ignore Exclude from docs\r\n * @todo Description\r\n */\nvar StyleClass = /** @class */function (_super) {\n  __extends(StyleClass, _super);\n  /**\r\n   * Constructor.\r\n   *\r\n   * @param styles  An object of style attribute - value pairs\r\n   * @param name    Class name\r\n   */\n  function StyleClass(element, styles, name) {\n    var _this = this;\n    var className = !$type.hasValue(name)\n    // TODO generate the classname randomly\n    ? \"__style_\" + ++styleId + \"__\" : name;\n    _this = _super.call(this, element, \".\" + className, styles) || this;\n    _this._className = className;\n    return _this;\n  }\n  Object.defineProperty(StyleClass.prototype, \"className\", {\n    /**\r\n     * @return Class name\r\n     */\n    get: function () {\n      return this._className;\n    },\n    /**\r\n     * Class name.\r\n     *\r\n     * @param name  Class name\r\n     */\n    set: function (name) {\n      this._className = name;\n      this.selector = \".\" + name;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  /**\r\n   * Converts the whole class to\r\n   * @ignore Exclude from docs\r\n   */\n  StyleClass.prototype.toString = function () {\n    return this._className;\n  };\n  return StyleClass;\n}(StyleRule);\nexport { StyleClass };\nexport function ready(f) {\n  if (document.readyState !== \"loading\") {\n    f();\n  } else {\n    var listener_1 = function () {\n      if (document.readyState !== \"loading\") {\n        document.removeEventListener(\"readystatechange\", listener_1);\n        f();\n      }\n    };\n    document.addEventListener(\"readystatechange\", listener_1);\n  }\n}\n/**\r\n * Returns a font fmaily name for the element (directly set or\r\n * computed/inherited).\r\n *\r\n * @ignore Exclude from docs\r\n * @param element  Element\r\n * @return Font family\r\n */\nexport function findFont(element) {\n  // Check if element has styles set\n  var font = getComputedStyle(element, \"font-family\");\n  if (!font) {\n    // Completely transparent. Look for a parent\n    var parent_1 = element.parentElement || element.parentNode;\n    if (parent_1) {\n      return findFont(parent_1);\n    } else {\n      return undefined;\n    }\n  } else {\n    return font;\n  }\n}\n/**\r\n * Returns a font fmaily name for the element (directly set or\r\n * computed/inherited).\r\n *\r\n * @ignore Exclude from docs\r\n * @param element  Element\r\n * @return Font family\r\n */\nexport function findFontSize(element) {\n  // Check if element has styles set\n  var font = getComputedStyle(element, \"font-size\");\n  if (!font) {\n    // Completely transparent. Look for a parent\n    var parent_2 = element.parentElement || element.parentNode;\n    if (parent_2) {\n      return findFontSize(parent_2);\n    } else {\n      return undefined;\n    }\n  } else {\n    return font;\n  }\n}\n/**\r\n * Checks whether element is not visible, whether directly or via its\r\n * ascendants.\r\n *\r\n * @param   element  Target element\r\n * @return           Hidden?\r\n */\nexport function isHidden(element) {\n  return element.offsetParent === null;\n}\n/**\r\n * Checks wthether element is in the current viewport.\r\n *\r\n * @since 2.5.5\r\n * @param   el Element\r\n * @return     Within viewport?\r\n */\nexport function isElementInViewport(el, viewportTarget) {\n  // Get position data of the element\n  var rect = el.getBoundingClientRect();\n  // Convert to array\n  var targets = $type.isArray(viewportTarget) ? viewportTarget : viewportTarget ? [viewportTarget] : [];\n  // Should we measure against specific viewport element?\n  if (targets.length) {\n    for (var i = 0; i < targets.length; i++) {\n      var target = targets[i];\n      // Check if viewport itself is visible\n      if (!isElementInViewport(target)) {\n        return false;\n      }\n      // Check if element is visible within the viewport\n      var viewportRect = target.getBoundingClientRect();\n      if (rect.top >= 0 && rect.left >= 0 && rect.top <= viewportRect.top + viewportRect.height && rect.left <= viewportRect.left + viewportRect.width) {\n        return true;\n      }\n    }\n    return false;\n  }\n  return rect.top >= 0 && rect.left >= 0 && rect.top <= (window.innerHeight || document.documentElement.clientHeight) && rect.left <= (window.innerWidth || document.documentElement.clientWidth);\n}","map":{"version":3,"names":["Disposer","readFrame","writeFrame","options","$object","$array","$type","SVGNS","XMLNS","XLINK","addEventListener","dom","type","listener","removeEventListener","getElement","el","isString","e","document","getElementById","getElementsByClassName","HTMLElement","addClass","element","className","classList","classes","split","each","name","add","currentClassName","getAttribute","setAttribute","filter","item","join","removeClass","remove","setStyle","property","value","style","getComputedStyle","currentStyle","defaultView","getPropertyValue","blur","activeElement","body","input","createElement","position","top","left","appendChild","focus","removeChild","fo","createElementNS","disabled","outerHTML","twrap","tnode","cloneNode","content","innerHTML","isElement","Object","nodeType","contains","a","b","cursor","parentNode","host","getShadowRoot","getRoot","owner","ownerDocument","eventTarget","event","composedPath","target","copyAttributes","source","attributes","attr","fixPixelPerfect","rect","getBoundingClientRect","left_1","Math","round","top_1","rootStylesheet","getStylesheet","hasValue","nonce","head","sheet","appendStylesheet","root","selector","index","cssRules","length","insertRule","StyleRule","_super","__extends","styles","_this","call","indexOf","_rule","Error","deleteRule","key","defineProperty","prototype","get","selectorText","set","_setVendorPrefixName","setProperty","styleId","StyleClass","_className","toString","ready","f","readyState","listener_1","findFont","font","parent_1","parentElement","undefined","findFontSize","parent_2","isHidden","offsetParent","isElementInViewport","viewportTarget","targets","isArray","i","viewportRect","height","width","window","innerHeight","documentElement","clientHeight","innerWidth","clientWidth"],"sources":["../../../../../src/.internal/core/utils/DOM.ts"],"sourcesContent":["/**\r\n * A collection of DOM-related functions.\r\n */\r\n\r\n/**\r\n * ============================================================================\r\n * IMPORTS\r\n * ============================================================================\r\n * @hidden\r\n */\r\nimport { Disposer, IDisposer } from \"./Disposer\";\r\nimport { readFrame, writeFrame } from \"./AsyncPending\";\r\nimport { options } from \"../Options\";\r\nimport * as $object from \"./Object\";\r\nimport * as $array from \"./Array\";\r\nimport * as $type from \"./Type\";\r\n\r\n/**\r\n * SVG namespace.\r\n *\r\n * @ignore Exclude from docs\r\n */\r\nexport const SVGNS: string = \"http://www.w3.org/2000/svg\";\r\n\r\n/**\r\n * XML namespace.\r\n *\r\n * @ignore Exclude from docs\r\n */\r\nexport const XMLNS: string = \"http://www.w3.org/2000/xmlns/\";\r\n\r\n/**\r\n * XLINK namespace.\r\n *\r\n * @ignore Exclude from docs\r\n */\r\nexport const XLINK: string = \"http://www.w3.org/1999/xlink\";\r\n\r\n\r\n/**\r\n * Function that adds a disposable event listener directly to a DOM element.\r\n *\r\n * @ignore Exclude from docs\r\n * @param dom       A DOM element to add event to\r\n * @param type      Event type\r\n * @param listener  Event listener\r\n * @returns Disposable event\r\n */\r\nexport function addEventListener<E extends Event>(dom: EventTarget, type: string, listener: (event: E) => void, options?: any): IDisposer {\r\n\t//@todo proper type check for options: EventListenerOptions | boolean (TS for some reason gives error on passive parameter)\r\n\t//console.log(type, dom);\r\n\tdom.addEventListener(type, <EventListener>listener, options || false);\r\n\r\n\treturn new Disposer(() => {\r\n\t\tdom.removeEventListener(type, <EventListener>listener, options || false);\r\n\t});\r\n}\r\n\r\n/**\r\n * Finds and returns an element reference using following logic:\r\n * * If we pass in an element instance, we just return it back.\r\n * * If we pass in a string, the function looks for an element with such id.\r\n * * If no element with such id is found, we grab the first element with a tag name like this.\r\n *\r\n * @ignore Exclude from docs\r\n * @param el  Element definition (reference, or id, or tag name)\r\n * @return Element reference\r\n * @todo Review this function as it seems pretty fuzzy and hacky\r\n */\r\nexport function getElement(el: $type.Optional<HTMLElement | string>): $type.Optional<HTMLElement> {\r\n\tif ($type.isString(el)) {\r\n\t\tlet e: Element | null = document.getElementById(el);\r\n\r\n\t\tif (e == null) {\r\n\t\t\te = document.getElementsByClassName(el)[0];\r\n\t\t}\r\n\r\n\t\tif (e instanceof HTMLElement) {\r\n\t\t\treturn e;\r\n\t\t}\r\n\r\n\t} else if (el instanceof HTMLElement) {\r\n\t\treturn el;\r\n\t}\r\n}\r\n\r\n/**\r\n * Adds a class name to an HTML or SVG element.\r\n *\r\n * @ignore Exclude from docs\r\n * @param element    Element\r\n * @param className  Class name to add\r\n */\r\nexport function addClass(element: HTMLElement | SVGSVGElement, className: string): void {\r\n\tif (!element) {\r\n\t\treturn;\r\n\t}\r\n\tif (element.classList) {\r\n\t\tconst classes = className.split(\" \");\r\n\t\t$array.each(classes, (name) => {\r\n\t\t\telement.classList.add(name);\r\n\t\t});\r\n\t}\r\n\telse {\r\n\t\tlet currentClassName = element.getAttribute(\"class\");\r\n\t\tif (currentClassName) {\r\n\t\t\telement.setAttribute(\"class\", currentClassName.split(\" \").filter((item) => {\r\n\t\t\t\treturn item !== className;\r\n\t\t\t}).join(\" \") + \" \" + className);\r\n\t\t}\r\n\t\telse {\r\n\t\t\telement.setAttribute(\"class\", className);\r\n\t\t}\r\n\t\t//element.className = element.className.replace(new RegExp(\"^\" + className + \"| \" + className), \"\") + \" \" + className;\r\n\t}\r\n}\r\n\r\n/**\r\n * Removes a class name from an HTML or SVG element.\r\n *\r\n * @ignore Exclude from docs\r\n * @param element    Element\r\n * @param className  Class name to add\r\n */\r\nexport function removeClass(element: HTMLElement | SVGSVGElement, className: string): void {\r\n\tif (!element) {\r\n\t\treturn;\r\n\t}\r\n\tif (element.classList) {\r\n\t\telement.classList.remove(className);\r\n\t}\r\n\telse {\r\n\t\tlet currentClassName = element.getAttribute(\"class\");\r\n\t\tif (currentClassName) {\r\n\t\t\telement.setAttribute(\"class\", currentClassName.split(\" \").filter((item) => {\r\n\t\t\t\treturn item !== className;\r\n\t\t\t}).join(\" \"));\r\n\t\t}\r\n\t\t//element.className = element.className.replace(new RegExp(\"^\" + className + \"| \" + className), \"\");\r\n\t}\r\n}\r\n\r\n/**\r\n * Sets style property on DOM element.\r\n *\r\n * @ignore Exclude from docs\r\n * @todo Still needed?\r\n */\r\nexport function setStyle(element: HTMLElement | SVGSVGElement, property: string, value: string): void {\r\n\t(<any>element.style)[property] = value;\r\n}\r\n\r\n/**\r\n * Gets the computed style value for an element.\r\n *\r\n * @ignore Exclude from docs\r\n */\r\nexport function getComputedStyle(element: Element, property: string): string | number {\r\n\r\n\tif ((<any>element).currentStyle) {\r\n\t\treturn (<any>element).currentStyle[property];\r\n\t}\r\n\r\n\treturn document.defaultView.getComputedStyle(element, null).getPropertyValue(property);\r\n}\r\n\r\n/**\r\n * Removes focus from any element by shifting focus to body.\r\n *\r\n * @ignore Exclude from docs\r\n */\r\nexport function blur(): void {\r\n\tif (document.activeElement && document.activeElement != document.body) {\r\n\t\tif ((<any>document.activeElement).blur) {\r\n\t\t\t(<any>document.activeElement).blur();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlet input = document.createElement(\"button\");\r\n\t\t\tinput.style.position = \"fixed\";\r\n\t\t\tinput.style.top = \"0px\";\r\n\t\t\tinput.style.left = \"-10000px\";\r\n\t\t\tdocument.body.appendChild(input);\r\n\t\t\tinput.focus();\r\n\t\t\tinput.blur();\r\n\t\t\tdocument.body.removeChild(input);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * Tries to focus the element.\r\n *\r\n * @ignore Exlude from docs\r\n * @param element  Element to focus\r\n */\r\nexport function focus(element: HTMLElement | SVGSVGElement): void {\r\n\r\n\tif (element instanceof HTMLElement) {\r\n\t\telement.focus();\r\n\t}\r\n\telse {\r\n\t\tlet input = document.createElement(\"input\");\r\n\t\tlet fo = <SVGSVGElement>document.createElementNS(SVGNS, \"foreignObject\");\r\n\t\tfo.appendChild(input);\r\n\t\telement.appendChild(fo);\r\n\t\tinput.focus();\r\n\t\tinput.disabled = true;\r\n\t\tfo.remove();\r\n\t}\r\n\r\n\t/*if ((<any>element).focus != undefined) {\r\n\t\t(<any>element).focus();\r\n\t}\r\n\telse if (element instanceof SVGSVGElement) {\r\n\t\t// Not implemented\r\n\t\t// @todo implement focus fallback\r\n\t}*/\r\n}\r\n\r\n/**\r\n * Returns markup for the element including the element tag itself.\r\n * SVG elements do not support `outerHTML` so this functions applies of\r\n * a workaround which creates a new temporary wrapper, clones element and uses\r\n * wrapper's `innerHTML`.\r\n *\r\n * @ignore Exclude from docs\r\n * @param element  Element to get full markup for\r\n * @return Markup\r\n * @deprecated Not in use anywhere\r\n */\r\nexport function outerHTML(element: HTMLElement | SVGSVGElement): string {\r\n\tif (element.outerHTML) {\r\n\t\treturn element.outerHTML;\r\n\t}\r\n\telse {\r\n\t\tlet twrap = document.createElement(\"div\");\r\n\t\tlet tnode = element.cloneNode(true);\r\n\t\ttwrap.appendChild(tnode);\r\n\t\tlet content = twrap.innerHTML;\r\n\t\treturn content;\r\n\t}\r\n}\r\n\r\n/**\r\n * Checks if element is a valid DOM node.\r\n *\r\n * @ignore Exclude from docs\r\n * @param el  Element\r\n * @return `true` if element is a valid DOM node\r\n */\r\nexport function isElement(el: HTMLElement): boolean {\r\n\treturn el instanceof Object && el && el.nodeType === 1;\r\n}\r\n\r\n/**\r\n * Checks of element `a` contains element `b`.\r\n *\r\n * @param a  Aleged ascendant\r\n * @param b  Aleged descendant\r\n * @return Contains?\r\n */\r\nexport function contains(a: HTMLElement | SVGSVGElement, b: HTMLElement | SVGSVGElement): boolean {\r\n\tlet cursor: Node = b;\r\n\r\n\twhile (true) {\r\n\t\tif (a === cursor) {\r\n\t\t\treturn true;\r\n\r\n\t\t} else if (cursor.parentNode == null) {\r\n\t\t\t// TODO better ShadowRoot detection\r\n\t\t\tif ((<ShadowRoot>cursor).host == null) {\r\n\t\t\t\treturn false;\r\n\r\n\t\t\t} else {\r\n\t\t\t\tcursor = (<ShadowRoot>cursor).host;\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\t\t\tcursor = cursor.parentNode;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * Returns the shadow root of the element or null\r\n *\r\n * @param a  Node\r\n * @return Root\r\n */\r\nexport function getShadowRoot(a: Node): ShadowRoot | null {\r\n\tlet cursor: Node = a;\r\n\r\n\twhile (true) {\r\n\t\tif (cursor.parentNode == null) {\r\n\t\t\t// TODO better ShadowRoot detection\r\n\t\t\tif ((<ShadowRoot>cursor).host != null) {\r\n\t\t\t\treturn <ShadowRoot>cursor;\r\n\r\n\t\t\t} else {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\t\t\tcursor = cursor.parentNode;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * Returns the root of the element (either the Document or the ShadowRoot)\r\n *\r\n * @param a  Node\r\n * @return Root\r\n */\r\nexport function getRoot(a: Node): Document | ShadowRoot | null {\r\n\t// TODO replace with Node.prototype.getRootNode\r\n\tconst owner = a.ownerDocument;\r\n\r\n\tlet cursor: Node = a;\r\n\r\n\twhile (true) {\r\n\t\tif (cursor.parentNode == null) {\r\n\t\t\t// If the cursor is the document, or it is a ShadowRoot\r\n\t\t\t// TODO better ShadowRoot detection\r\n\t\t\tif (cursor === owner || (<ShadowRoot>cursor).host != null) {\r\n\t\t\t\treturn <Document | ShadowRoot>cursor;\r\n\r\n\t\t\t} else {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\t\t\tcursor = cursor.parentNode;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * Gets the true target of the Event.\r\n *\r\n * This is needed to make events work with the shadow DOM.\r\n *\r\n * @param event  Event\r\n * @return EventTarget\r\n */\r\nexport function eventTarget(event: Event): EventTarget {\r\n\tif (typeof (<any>event).composedPath === \"function\") {\r\n\t\treturn (<any>event).composedPath()[0];\r\n\r\n\t} else {\r\n\t\treturn event.target;\r\n\t}\r\n}\r\n\r\n/**\r\n * Copies attributes from one element to another.\r\n *\r\n * @ignore Exclude from docs\r\n * @param source  Element to copy attributes from\r\n * @param target  Element to copy attributes to\r\n */\r\nexport function copyAttributes(source: Element | HTMLElement | SVGSVGElement, target: HTMLElement | SVGSVGElement): void {\r\n\t$array.each(source.attributes, (attr) => {\r\n\t\t// TODO what if it's null ?\r\n\t\tif (attr.value != null) {\r\n\t\t\ttarget.setAttribute(attr.name, attr.value);\r\n\t\t}\r\n\t});\r\n}\r\n\r\n/**\r\n * [fixPixelPerfect description]\r\n *\r\n * @ignore Exclude from docs\r\n * @todo Description\r\n * @param el  Element\r\n */\r\nexport function fixPixelPerfect(el: HTMLElement): void {\r\n\treadFrame(() => {\r\n\t\t// sometimes IE doesn't like this\r\n\t\t// TODO figure out a way to remove this\r\n\t\ttry {\r\n\t\t\tconst rect = el.getBoundingClientRect();\r\n\r\n\t\t\tconst left = rect.left - Math.round(rect.left);\r\n\t\t\tconst top = rect.top - Math.round(rect.top);\r\n\r\n\t\t\tif (left !== 0) {\r\n\t\t\t\twriteFrame(() => {\r\n\t\t\t\t\tel.style.left = left + \"px\";\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tif (top !== 0) {\r\n\t\t\t\twriteFrame(() => {\r\n\t\t\t\t\tel.style.top = top + \"px\";\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t} catch (e) { }\r\n\t});\r\n}\r\n\r\n/**\r\n * [rootStylesheet description]\r\n *\r\n * @ignore Exclude from docs\r\n * @todo Description\r\n */\r\nlet rootStylesheet: $type.Optional<CSSStyleSheet>;\r\n\r\n/**\r\n * [getStylesheet description]\r\n *\r\n * @ignore Exclude from docs\r\n * @todo Description\r\n * @return [description]\r\n */\r\nfunction getStylesheet(element: ShadowRoot | null): CSSStyleSheet {\r\n\tif (element == null) {\r\n\t\tif (!$type.hasValue(rootStylesheet)) {\r\n\t\t\t// TODO use createElementNS ?\r\n\t\t\tconst e = document.createElement(\"style\");\r\n\t\t\te.type = \"text/css\";\r\n\t\t\tif (options.nonce != \"\") {\r\n\t\t\t\te.setAttribute(\"nonce\", options.nonce)\r\n\t\t\t}\r\n\t\t\tdocument.head.appendChild(e);\r\n\t\t\trootStylesheet = e.sheet as CSSStyleSheet;\r\n\t\t}\r\n\r\n\t\treturn rootStylesheet;\r\n\r\n\t} else {\r\n\t\t// TODO use createElementNS ?\r\n\t\tconst e = document.createElement(\"style\");\r\n\t\te.type = \"text/css\";\r\n\t\tif (options.nonce != \"\") {\r\n\t\t\te.setAttribute(\"nonce\", options.nonce)\r\n\t\t}\r\n\t\telement.appendChild(e);\r\n\t\treturn e.sheet as CSSStyleSheet;\r\n\t}\r\n}\r\n\r\n/**\r\n * [makeStylesheet description]\r\n *\r\n * @ignore Exclude from docs\r\n * @todo Description\r\n * @param selector  [description]\r\n * @return [description]\r\n */\r\nfunction appendStylesheet(root: CSSStyleSheet, selector: string): CSSStyleRule {\r\n\tconst index = root.cssRules.length;\r\n\r\n\troot.insertRule(selector + \"{}\", index);\r\n\r\n\treturn root.cssRules[index] as CSSStyleRule;\r\n}\r\n\r\n/**\r\n * Defines a class for a CSS rule.\r\n *\r\n * Can be used to dynamically add CSS to the document.\r\n */\r\nexport class StyleRule extends Disposer {\r\n\r\n\t/**\r\n\t * CSS rule.\r\n\t */\r\n\tprivate _rule: CSSStyleRule;\r\n\r\n\t/**\r\n\t * A CSS selector text.\r\n\t *\r\n\t * E.g.: `.myClass p`\r\n\t *\r\n\t * @param selector  CSS selector\r\n\t */\r\n\tpublic set selector(selector: string) {\r\n\t\tthis._rule.selectorText = selector;\r\n\t}\r\n\r\n\t/**\r\n\t * @return CSS selector\r\n\t */\r\n\tpublic get selector(): string {\r\n\t\treturn this._rule.selectorText;\r\n\t}\r\n\r\n\t/**\r\n\t * Constructor.\r\n\t *\r\n\t * @param selector  CSS selector\r\n\t * @param styles    An object of style attribute - value pairs\r\n\t */\r\n\tconstructor(element: ShadowRoot | null, selector: string, styles: { [name: string]: string }) {\r\n\t\tconst root = getStylesheet(element);\r\n\r\n\t\t// TODO test this\r\n\t\tsuper(() => {\r\n\t\t\t// TODO a bit hacky\r\n\t\t\tconst index = $array.indexOf(root.cssRules, this._rule);\r\n\r\n\t\t\tif (index === -1) {\r\n\t\t\t\tthrow new Error(\"Could not dispose StyleRule\");\r\n\r\n\t\t\t} else {\r\n\t\t\t\t// TODO if it's empty remove it from the DOM ?\r\n\t\t\t\troot.deleteRule(index);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis._rule = appendStylesheet(root, selector);\r\n\r\n\t\t$object.each(styles, (key, value) => {\r\n\t\t\tthis.setStyle(key, value);\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Sets the same style properties with browser-specific prefixes.\r\n\t *\r\n\t * @param name   Attribute name\r\n\t * @param value  Attribute value\r\n\t */\r\n\tprivate _setVendorPrefixName(name: string, value: string): void {\r\n\t\tconst style = this._rule.style;\r\n\t\tstyle.setProperty(\"-webkit-\" + name, value, \"\");\r\n\t\tstyle.setProperty(\"-moz-\" + name, value, \"\");\r\n\t\tstyle.setProperty(\"-ms-\" + name, value, \"\");\r\n\t\tstyle.setProperty(\"-o-\" + name, value, \"\");\r\n\t\tstyle.setProperty(name, value, \"\");\r\n\t}\r\n\r\n\t/**\r\n\t * Sets a value for specific style attribute.\r\n\t *\r\n\t * @param name   Attribute\r\n\t * @param value  Value\r\n\t */\r\n\tpublic setStyle(name: string, value: string): void {\r\n\t\tif (name === \"transition\") {\r\n\t\t\tthis._setVendorPrefixName(name, value);\r\n\r\n\t\t} else {\r\n\t\t\tthis._rule.style.setProperty(name, value, \"\");\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n * An internal counter for unique style ids.\r\n *\r\n * @ignore Exclude from docs\r\n */\r\nlet styleId: number = 0;\r\n\r\n/**\r\n * @ignore Exclude from docs\r\n * @todo Description\r\n */\r\nexport class StyleClass extends StyleRule {\r\n\r\n\t/**\r\n\t * Class name.\r\n\t */\r\n\tprivate _className: string;\r\n\r\n\t/**\r\n\t * Constructor.\r\n\t *\r\n\t * @param styles  An object of style attribute - value pairs\r\n\t * @param name    Class name\r\n\t */\r\n\tconstructor(element: ShadowRoot | null, styles: { [name: string]: string }, name?: string) {\r\n\t\tconst className =\r\n\t\t\t(!$type.hasValue(name)\r\n\t\t\t\t// TODO generate the classname randomly\r\n\t\t\t\t? \"__style_\" + (++styleId) + \"__\"\r\n\t\t\t\t: name);\r\n\r\n\t\tsuper(element, \".\" + className, styles);\r\n\r\n\t\tthis._className = className;\r\n\t}\r\n\r\n\t/**\r\n\t * Class name.\r\n\t *\r\n\t * @param name  Class name\r\n\t */\r\n\tpublic set className(name: string) {\r\n\t\tthis._className = name;\r\n\t\tthis.selector = \".\" + name;\r\n\t}\r\n\r\n\t/**\r\n\t * @return Class name\r\n\t */\r\n\tpublic get className(): string {\r\n\t\treturn this._className;\r\n\t}\r\n\r\n\t/**\r\n\t * Converts the whole class to\r\n\t * @ignore Exclude from docs\r\n\t */\r\n\tpublic toString(): string {\r\n\t\treturn this._className;\r\n\t}\r\n\r\n}\r\n\r\n\r\nexport function ready(f: () => void): void {\r\n\tif (document.readyState !== \"loading\") {\r\n\t\tf();\r\n\r\n\t} else {\r\n\t\tconst listener = () => {\r\n\t\t\tif (document.readyState !== \"loading\") {\r\n\t\t\t\tdocument.removeEventListener(\"readystatechange\", listener);\r\n\t\t\t\tf();\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tdocument.addEventListener(\"readystatechange\", listener);\r\n\t}\r\n}\r\n\r\n/**\r\n * Returns a font fmaily name for the element (directly set or\r\n * computed/inherited).\r\n *\r\n * @ignore Exclude from docs\r\n * @param element  Element\r\n * @return Font family\r\n */\r\nexport function findFont(element: Element): string {\r\n\r\n\t// Check if element has styles set\r\n\tlet font = getComputedStyle(element, \"font-family\");\r\n\r\n\tif (!font) {\r\n\t\t// Completely transparent. Look for a parent\r\n\t\tlet parent = element.parentElement || <Element>element.parentNode;\r\n\t\tif (parent) {\r\n\t\t\treturn findFont(parent);\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\treturn (<string>font);\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n * Returns a font fmaily name for the element (directly set or\r\n * computed/inherited).\r\n *\r\n * @ignore Exclude from docs\r\n * @param element  Element\r\n * @return Font family\r\n */\r\nexport function findFontSize(element: Element): string {\r\n\r\n\t// Check if element has styles set\r\n\tlet font = getComputedStyle(element, \"font-size\");\r\n\r\n\tif (!font) {\r\n\t\t// Completely transparent. Look for a parent\r\n\t\tlet parent = element.parentElement || <Element>element.parentNode;\r\n\t\tif (parent) {\r\n\t\t\treturn findFontSize(parent);\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\treturn (<string>font);\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n * Checks whether element is not visible, whether directly or via its\r\n * ascendants.\r\n *\r\n * @param   element  Target element\r\n * @return           Hidden?\r\n */\r\nexport function isHidden(element: HTMLElement): boolean {\r\n\treturn (element.offsetParent === null);\r\n}\r\n\r\n\r\n/**\r\n * Checks wthether element is in the current viewport.\r\n *\r\n * @since 2.5.5\r\n * @param   el Element\r\n * @return     Within viewport?\r\n */\r\nexport function isElementInViewport(el: HTMLElement, viewportTarget?: HTMLElement | HTMLElement[]): boolean {\r\n\r\n\t// Get position data of the element\r\n\tlet rect = el.getBoundingClientRect();\r\n\r\n\t// Convert to array\r\n\tconst targets = $type.isArray(viewportTarget) ? viewportTarget : viewportTarget ? [viewportTarget] : [];\r\n\r\n\t// Should we measure against specific viewport element?\r\n\tif (targets.length) {\r\n\t\tfor (let i = 0; i < targets.length; i++) {\r\n\r\n\t\t\tconst target = targets[i];\r\n\r\n\t\t\t// Check if viewport itself is visible\r\n\t\t\tif (!isElementInViewport(target)) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\t// Check if element is visible within the viewport\r\n\t\t\tlet viewportRect = target.getBoundingClientRect();\r\n\t\t\tif (\r\n\t\t\t\trect.top >= 0 &&\r\n\t\t\t\trect.left >= 0 &&\r\n\t\t\t\trect.top <= (viewportRect.top + viewportRect.height) &&\r\n\t\t\t\trect.left <= (viewportRect.left + viewportRect.width)\r\n\t\t\t) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\treturn (\r\n\t\trect.top >= 0 &&\r\n\t\trect.left >= 0 &&\r\n\t\trect.top <= (window.innerHeight || document.documentElement.clientHeight) &&\r\n\t\trect.left <= (window.innerWidth || document.documentElement.clientWidth)\r\n\t);\r\n\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}