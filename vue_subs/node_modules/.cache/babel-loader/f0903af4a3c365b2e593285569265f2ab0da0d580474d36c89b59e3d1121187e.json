{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport * as $array from \"./Array\";\nimport * as $log from \"./Log\";\nvar Native = /** @class */function () {\n  function Native() {\n    var _this = this;\n    this._targets = [];\n    this._observer = new ResizeObserver(function (entries) {\n      $array.each(entries, function (entry) {\n        $array.each(_this._targets, function (x) {\n          if (x.target === entry.target) {\n            x.callback();\n          }\n        });\n      });\n    });\n  }\n  Native.prototype.addTarget = function (target, callback) {\n    this._observer.observe(target, {\n      box: \"content-box\"\n    });\n    this._targets.push({\n      target: target,\n      callback: callback\n    });\n  };\n  Native.prototype.removeTarget = function (target) {\n    this._observer.unobserve(target);\n    $array.keepIf(this._targets, function (x) {\n      return x.target !== target;\n    });\n  };\n  return Native;\n}();\nvar Raf = /** @class */function () {\n  function Raf() {\n    this._targets = [];\n  }\n  Raf.prototype.addTarget = function (target, callback) {\n    var _this = this;\n    if (this._targets.length === 0) {\n      var lastTime_1 = null;\n      var loop_1 = function () {\n        var currentTime = Date.now();\n        if (lastTime_1 === null || currentTime > lastTime_1 + Raf.delay) {\n          lastTime_1 = currentTime;\n          $array.each(_this._targets, function (x) {\n            var newSize = x.target.getBoundingClientRect();\n            if (newSize.width !== x.size.width || newSize.height !== x.size.height) {\n              x.size = newSize;\n              x.callback();\n            }\n          });\n        }\n        _this._timer = requestAnimationFrame(loop_1);\n      };\n      this._timer = requestAnimationFrame(loop_1);\n    }\n    var size = target.getBoundingClientRect();\n    this._targets.push({\n      target: target,\n      callback: callback,\n      size: size\n    });\n  };\n  Raf.prototype.removeTarget = function (target) {\n    $array.keepIf(this._targets, function (x) {\n      return x.target !== target;\n    });\n    if (this._targets.length === 0) {\n      cancelAnimationFrame(this._timer);\n    }\n  };\n  Raf.delay = 200;\n  return Raf;\n}();\nvar observer = null;\nfunction makeSensor() {\n  if (observer === null) {\n    if (typeof ResizeObserver !== \"undefined\") {\n      observer = new Native();\n    } else {\n      observer = new Raf();\n    }\n  }\n  return observer;\n}\nvar ResizeSensor = /** @class */function () {\n  function ResizeSensor(element, callback) {\n    this._disposed = false;\n    this._sensor = makeSensor();\n    this._element = element;\n    this._sensor.addTarget(element, callback);\n  }\n  ResizeSensor.prototype.isDisposed = function () {\n    return this._disposed;\n  };\n  ResizeSensor.prototype.dispose = function () {\n    if (!this._disposed) {\n      this._disposed = true;\n      this._sensor.removeTarget(this._element);\n    }\n  };\n  Object.defineProperty(ResizeSensor.prototype, \"sensor\", {\n    get: function () {\n      return this._sensor;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  /**\r\n   * Deprecated: do not use.\r\n   *\r\n   * @ignore Exclude from docs\r\n   */\n  ResizeSensor.prototype.reset = function () {\n    $log.warn(\"resizeSensor.reset() is no longer needed and can be removed\");\n  };\n  return ResizeSensor;\n}();\nexport { ResizeSensor };","map":{"version":3,"names":["$array","$log","Native","_this","_targets","_observer","ResizeObserver","entries","each","entry","x","target","callback","prototype","addTarget","observe","box","push","removeTarget","unobserve","keepIf","Raf","length","lastTime_1","loop_1","currentTime","Date","now","delay","newSize","getBoundingClientRect","width","size","height","_timer","requestAnimationFrame","cancelAnimationFrame","observer","makeSensor","ResizeSensor","element","_disposed","_sensor","_element","isDisposed","dispose","Object","defineProperty","get","reset","warn"],"sources":["../../../../../src/.internal/core/utils/ResizeSensor.ts"],"sourcesContent":["import * as $array from \"./Array\";\nimport * as $log from \"./Log\";\n\n\ninterface Sensor {\n\taddTarget(target: Element, callback: () => void): void;\n\tremoveTarget(target: Element): void;\n}\n\n\ndeclare const ResizeObserver: any;\n\nclass Native implements Sensor {\n\tprivate _observer: any;\n\tprivate _targets: Array<{ target: Element, callback: () => void }> = [];\n\n\tconstructor() {\n\t\tthis._observer = new ResizeObserver((entries: Array<any>) => {\n\t\t\t$array.each(entries, (entry) => {\n\t\t\t\t$array.each(this._targets, (x) => {\n\t\t\t\t\tif (x.target === entry.target) {\n\t\t\t\t\t\tx.callback();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\taddTarget(target: Element, callback: () => void) {\n\t\tthis._observer.observe(target, { box: \"content-box\" });\n\t\tthis._targets.push({ target, callback });\n\t}\n\n\tremoveTarget(target: Element) {\n\t\tthis._observer.unobserve(target);\n\n\t\t$array.keepIf(this._targets, (x) => {\n\t\t\treturn x.target !== target;\n\t\t});\n\t}\n}\n\n\nclass Raf implements Sensor {\n\tpublic static delay: number = 200;\n\n\tprivate _timer: number | undefined;\n\tprivate _targets: Array<{ target: Element, callback: () => void, size: ClientRect | DOMRect }> = [];\n\n\taddTarget(target: Element, callback: () => void) {\n\t\tif (this._targets.length === 0) {\n\t\t\tlet lastTime: number | null = null;\n\n\t\t\tconst loop = () => {\n\t\t\t\tconst currentTime = Date.now();\n\n\t\t\t\tif (lastTime === null || currentTime > (lastTime + Raf.delay)) {\n\t\t\t\t\tlastTime = currentTime;\n\n\t\t\t\t\t$array.each(this._targets, (x) => {\n\t\t\t\t\t\tlet newSize = x.target.getBoundingClientRect();\n\n\t\t\t\t\t\tif (newSize.width !== x.size.width || newSize.height !== x.size.height) {\n\t\t\t\t\t\t\tx.size = newSize;\n\t\t\t\t\t\t\tx.callback();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tthis._timer = requestAnimationFrame(loop);\n\t\t\t};\n\n\t\t\tthis._timer = requestAnimationFrame(loop);\n\t\t}\n\n\t\tlet size = target.getBoundingClientRect();\n\t\tthis._targets.push({ target, callback, size });\n\t}\n\n\tremoveTarget(target: Element) {\n\t\t$array.keepIf(this._targets, (x) => {\n\t\t\treturn x.target !== target;\n\t\t});\n\n\t\tif (this._targets.length === 0) {\n\t\t\tcancelAnimationFrame(this._timer);\n\t\t}\n\t}\n}\n\n\nlet observer: Sensor | null = null;\n\nfunction makeSensor(): Sensor {\n\tif (observer === null) {\n\t\tif (typeof ResizeObserver !== \"undefined\") {\n\t\t\tobserver = new Native();\n\n\t\t} else {\n\t\t\tobserver = new Raf();\n\t\t}\n\t}\n\n\treturn observer;\n}\n\nexport class ResizeSensor {\n\tprivate _sensor: Sensor;\n\tprivate _element: Element;\n\tprivate _disposed: boolean = false;\n\n\tconstructor(element: Element, callback: () => void) {\n\t\tthis._sensor = makeSensor();\n\t\tthis._element = element;\n\t\tthis._sensor.addTarget(element, callback);\n\t}\n\n\tpublic isDisposed() {\n\t\treturn this._disposed;\n\t}\n\n\tpublic dispose() {\n\t\tif (!this._disposed) {\n\t\t\tthis._disposed = true;\n\t\t\tthis._sensor.removeTarget(this._element);\n\t\t}\n\t}\n\n\tpublic get sensor(): Sensor {\n\t\treturn this._sensor;\n\t}\n\n\t/**\n\t * Deprecated: do not use.\n\t *\n\t * @ignore Exclude from docs\n\t */\n\tpublic reset() {\n\t\t$log.warn(\"resizeSensor.reset() is no longer needed and can be removed\");\n\t}\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}